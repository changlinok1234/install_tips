\documentclass[12pt]{article}
%%---------------------------------------------------------------------
% packages
% geometry
\usepackage{geometry}
% font
\usepackage{fontspec}
\defaultfontfeatures{Mapping=tex-text}  %%如果没有它，会有一些 tex 特殊字符无法正常使用，比如连字符。
\usepackage{xunicode,xltxtra}
\usepackage[BoldFont,SlantFont,CJKnumber,CJKchecksingle]{xeCJK}  % \CJKnumber{12345}: 一万二千三百四十五
\usepackage{CJKfntef}  %%实现对汉字加点、下划线等。
\usepackage{pifont}  % \ding{}
% math
\usepackage{amsmath,amsfonts,amssymb}
% color
\usepackage{color}
\usepackage{xcolor}
\definecolor{EYE}{RGB}{199,237,204}
\definecolor{FLY}{RGB}{128,0,128}
\definecolor{ZHY}{RGB}{139,0,255}
% graphics
\usepackage[americaninductors,europeanresistors]{circuitikz}
\usepackage{tikz}
\usetikzlibrary{positioning,arrows,shadows,shapes,calc,mindmap,trees,backgrounds}  % placements=positioning
\usepackage{graphicx}  % \includegraphics[]{}
\usepackage{subfigure}  %%图形或表格并排排列
% table
\usepackage{colortbl,dcolumn}  %% 彩色表格
\usepackage{multirow}
\usepackage{multicol}
\usepackage{booktabs}
% code
\usepackage{fancyvrb}
\usepackage{listings}
% title
\usepackage{titlesec}
% head/foot
\usepackage{fancyhdr}
% ref
\usepackage{hyperref} %生成可链接目录
% pagecolor
\usepackage[pagecolor={EYE}]{pagecolor}
% tightly-packed lists
\usepackage{mdwlist}
\usepackage{verbatim}%comment命令的注释包
\usepackage{styles/iplouccfg}
\usepackage{styles/zhfontcfg}
\usepackage{styles/iplouclistings}
%%---------------------------------------------------------------------
% settings
% geometry
\geometry{left=2cm,right=1cm,top=2cm,bottom=2cm}  %设置 上、左、下、右 页边距
\linespread{1.5} %行间距
% font
\setCJKmainfont{Adobe Kaiti Std}
%\setmainfont[BoldFont=Adobe Garamond Pro Bold]{Apple Garamond}  % 英文字体
%\setmainfont[BoldFont=Adobe Garamond Pro Bold,SmallCapsFont=Apple Garamond,SmallCapsFeatures={Scale=0.7}]{Apple Garamond}  %%苹果字体没有SmallCaps
\setCJKmonofont{Adobe Fangsong Std}
% graphics
\graphicspath{{figures/}}
\tikzset{
    % Define standard arrow tip
    >=stealth',
    % Define style for boxes
    punkt/.style={
           rectangle,
           rounded corners,
           draw=black, very thick,
           text width=6.5em,
           minimum height=2em,
           text centered},
    % Define arrow style
    pil/.style={
           ->,
           thick,
           shorten <=2pt,
           shorten >=2pt,},
    % Define style for FlyZhyBall
    FlyZhyBall/.style={
      circle,
      minimum size=6mm,
      inner sep=0.5pt,
      ball color=red!50!blue,
      text=white,},
    % Define style for FlyZhyRectangle
    FlyZhyRectangle/.style={
      rectangle,
      rounded corners,
      minimum size=6mm,
      ball color=red!50!blue,
      text=white,},
    % Define style for zhyfly
    zhyfly/.style={
      rectangle,
      rounded corners,
      minimum size=6mm,
      ball color=red!25!blue,
      text=white,},
    % Define style for new rectangle
    nrectangle/.style={
      rectangle,
      draw=#1!50,
      fill=#1!20,
      minimum size=5mm,
      inner sep=0.1pt,}
}
\ctikzset{
  bipoles/length=.8cm
}
% code
\lstnewenvironment{VHDLcode}[1][]{%
  \lstset{
    basicstyle=\footnotesize\ttfamily\color{black},%
    columns=flexible,%
    framexleftmargin=.7mm,frame=shadowbox,%
    rulesepcolor=\color{blue},%
%    frame=single,%
    backgroundcolor=\color{yellow!20},%
    xleftmargin=1.2\fboxsep,%
    xrightmargin=.7\fboxsep,%
    numbers=left,numberstyle=\tiny\color{blue},%
    numberblanklines=false,numbersep=7pt,%
    language=VHDL%
    }\lstset{#1}}{}
\lstnewenvironment{VHDLmiddle}[1][]{%
  \lstset{
    basicstyle=\scriptsize\ttfamily\color{black},%
    columns=flexible,%
    framexleftmargin=.7mm,frame=shadowbox,%
    rulesepcolor=\color{blue},%
%    frame=single,%
    backgroundcolor=\color{yellow!20},%
    xleftmargin=1.2\fboxsep,%
    xrightmargin=.7\fboxsep,%
    numbers=left,numberstyle=\tiny\color{blue},%
    numberblanklines=false,numbersep=7pt,%
    language=VHDL%
    }\lstset{#1}}{}
\lstnewenvironment{VHDLsmall}[1][]{%
  \lstset{
    basicstyle=\tiny\ttfamily\color{black},%
    columns=flexible,%
    framexleftmargin=.7mm,frame=shadowbox,%
    rulesepcolor=\color{blue},%
%    frame=single,%
    backgroundcolor=\color{yellow!20},%
    xleftmargin=1.2\fboxsep,%
    xrightmargin=.7\fboxsep,%
    numbers=left,numberstyle=\tiny\color{blue},%
    numberblanklines=false,numbersep=7pt,%
    language=VHDL%
    }\lstset{#1}}{}
% pdf
\hypersetup{pdfauthor={Haiyong Zheng},%
            pdftitle={Title},%
            CJKbookmarks=true,%
            bookmarksnumbered=true,%
            bookmarksopen=false,%
            plainpages=false,%
            colorlinks=true,%
            citecolor=green,%
            filecolor=magenta,%
            linkcolor=cyan,%red(default)
            urlcolor=cyan}
% section
%http://tex.stackexchange.com/questions/34288/how-to-place-a-shaded-box-around-a-section-label-and-name
\newcommand\titlebar{%
\tikz[baseline,trim left=3.1cm,trim right=3cm] {
    \fill [cyan!25] (2.5cm,-1ex) rectangle (\textwidth+3.1cm,2.5ex);
    \node [
        fill=cyan!60!white,
        anchor= base east,
        rounded rectangle,
        minimum height=3.5ex] at (3cm,0) {
        \textbf{\thesection.}
    };
}%
}
\titleformat{\section}{\Large\bf\color{blue}}{\titlebar}{0.1cm}{}
% head/foot
\setlength{\headheight}{15pt}
\pagestyle{fancy}
\fancyhf{}
%\lhead{\color{black!50!green}2014年秋季学期}
\chead{\color{black!50!green}Codeblocks与Opencv的安装与配置}
%\rhead{\color{black!50!green}通信电子电路}
\lfoot{\color{blue!50!green}常琳（整理）}
%\cfoot{\color{blue!50!green}\href{http://vision.ouc.edu.cn/~zhenghaiyong}{CVBIOUC}}
\rfoot{\color{blue!50!green}$\cdot$\ \thepage\ $\cdot$}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}

%%---------------------------------------------------------------------
\begin{document}
%%---------------------------------------------------------------------
%%---------------------------------------------------------------------
% \titlepage
\title{\vspace{-2em}Codeblocks与Opencv的安装与配置\vspace{-0.7em}}
\author{常琳（整理）}
\date{\vspace{-0.7em}2015年8月\vspace{-0.7em}}
%%---------------------------------------------------------------------
\maketitle\thispagestyle{fancy}
%%---------------------------------------------------------------------
\maketitle
\tableofcontents 
%---------------------------------------------------------------------

\section{codeblocks安装}

\begin{enumerate}

\item 安装基本编译环境

\begin{lstlisting}
sudo apt-get install build-essential 
sudo apt-get install
\end{lstlisting}

%build-essential是c语言的开发包，包含了gcc make gdb和libc函数库很多工具

\item 安装codeblocks

sudo apt-get install codeblocks

%sudo apt-get install codeblocks-dbg  可选扩展

\begin{comment}

wxWidgets 工具包提供图形用户界面（GUI）开发所需的一些功能强大的跨平台工具。除了原生的 C++, 还有其他几种语言提供了使用该工具包所需的包装程序。我们一般用不到，可以先不装

sudo apt-get install wxformbuilder

\item 安装wxWidgets

sudo apt-get install libwxbase2.8

sudo apt-get install libwxbase2.8-dev

sudo apt-get install libwxgtk2.8-0

sudo apt-get install libwxgtk2.8-dev

sudo apt-get install libwxgtk2.8-dbg

sudo apt-get install wx-common

sudo apt-get install wx2.8-headers

sudo apt-get install wx2.8-i18n

wx2.8-examples和wx2.8-doc想看文档可以装上

\item 配置codeblocks

打开codeblocks

settings->global variables

current variable标签后面点击new按钮，出来的框框填写wx

然后 built-in fields下面

base /usr

include /usr/include/wx-2.8

lib /usr/lib

点击close保存
 
\end{comment}

\end{enumerate}

\section{安装opencv}

\begin{enumerate}

\item 系统更新

\begin{lstlisting}
sudo apt-get update
sudo apt-get upgrade
\end{lstlisting}

\item 安装必要的组件
\begin{lstlisting}
sudo apt-get install build-essential libgtk2.0-dev libjpeg-dev libtiff4-dev libjasper-dev libopenexr-dev cmake python-dev python-numpy python-tk libtbb-dev libeigen3-dev yasm libfaac-dev libopencore-amrnb-dev libopencore-amrwb-dev libtheora-dev libvorbis-dev libxvidcore-dev libx264-dev libqt4-dev libqt4-opengl-dev sphinx-common texlive-latex-extra libv4l-dev libdc1394-22-dev libavcodec-dev libavformat-dev libswscale-dev default-jdk ant libvtk5-qt4-dev
\end{lstlisting}
\item 编译opecv3.0

进入解压后的opencv3.0目录

mkdir build

进入build目录
\begin{lstlisting}
cd build
cmake -D CMAKE_BUILD_TYPE=Release -D CMAKE_INSTALL_PREFIX=/usr/local ..
\end{lstlisting}

% cmake -D WITH\_TBB=ON -D BUILD\_NEW\_PYTHON\_SUPPORT=ON -D WITH\_V4L=ON -D INSTALL\_C\_EXAMPLES=ON -D INSTALL\_PYTHON\_EXAMPLES=ON -D BUILD\_EXAMPLES=ON -D WITH\_QT=ON -D WITH\_OPENGL=ON ..

\item 安装opencv3.0

在build目录

\begin{enumerate}

\item make  

若make编译失败，出现如下错误：

make[2 ]:*** [modules/java/core+Algorithm-jdoc.java] 错误126

make[1]:*** [modules/java/CmakeFiles/opencv\_java.dir/all ]错误2

make:*** [all] 错误 2

搜网上解决方案，把CMakeLists.txt里的有关java的--java support--和==java==部分删掉之后就不会再报错了，其他影响未知

\item sudo make install

\end{enumerate}

\item 配置opencv.conf file ，加入环境变量  

sudo gedit /etc/ld.so.conf.d/opencv.conf

在opencv.conf里面加入命令

/usr/local/lib

更新库目录

sudo ldconfig

\item 配置cmake路径

打开文件bash.bashrc  

sudo gedit /etc/bash.bashrc

加入下面两行

PKG\_CONFIG\_PATH=\$PKG\_CONFIG\_PATH:/usr/local/lib/pkgconfig

export PKG\_CONFIG\_PATH\

\end{enumerate}

\section{配置}

\begin{enumerate}
\item codeblocks链接库配置：Project->Build Options(要在setting->compiler里相同的配一遍全局，才能保存当前设置)

test1(工程名称)->Linker settings

在Link libraries下面写

/../../../usr/local/lib/libopencv\_core.so

/../../../usr/local/lib/libopencv\_highgui.so

以上仅是列举，lib里的文件都要加进去，文件夹就不用关了

\item codeblocks头文件目录配置 （可用pkg-config $--$cflags opencv 查看配置结果）

还是在Project->Build Options(要在setting->compiler里相同的配一遍全局，才能保存当前设置)里找

test1->Search directories->Compiler

/usr/local/include/opencv

/usr/local/include/opencv2

include里opencv的包都要加上

\begin{comment}

\item CodeBlocks 路文件目录配置

test1->Search directories->Linker

/usr/lib

\end{comment}

安装好后，用testprogram里的.cbp文件测试下

\end{enumerate}

\begin{description}

\item [注意事项1]如果哪天你保存好文件，建立好连接不报错，点运行时，总是提示你程序还没有"build"，而且你点"yes"之后没有预想的结果出来。

\item [解决方案]可能是opencv更新了什么东西编译软件还没能识别，需要在终端输入：sudo ldconfig

\item [注意事项2(汤宁贡献)]安装codeblocks并进行opencv全局关联配置后,无法保存配置,即每次打开新的工程都要重新进行关联配置。

\item [问题出现的原因]codeblocks的所有者和用户组是root而不是使用者本人。

\item [解决方案]终端～目录下输入 ls -la查看.codeblocks文件夹的所有者和用户是否是使用者本人，如果是root就要对其进行更改。方式：

chown -R 用户名 .codeblocks

chgrp -R 用户名 .codeblocks

更改.codeblocks的所有者和用户组

\end{description}

参考网址：

\url{http://blog.csdn.net/adong76/article/details/40018407}
          
\url{http://blog.csdn.net/hitwengqi/article/details/7985343}

\end{document}

